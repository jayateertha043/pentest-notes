
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Cross Origin Resource Sharing (CORS) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../security-headers/" />
    
    
    <link rel="prev" href="same-origin-policy-sop.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Pentest Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    Web
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../common-vulnerabilities-and-suggested-fixes.html">
            
                <a href="../common-vulnerabilities-and-suggested-fixes.html">
            
                    
                    Common Vulnerabilities & Suggested Fixes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../authentication-mechanism-and-vulnerabilities/">
            
                <a href="../authentication-mechanism-and-vulnerabilities/">
            
                    
                    Authentication Mechanism & Vulnerabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../authentication-mechanism-and-vulnerabilities/oauth-2.0.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/oauth-2.0.html">
            
                    
                    OAUTH 2.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../authentication-mechanism-and-vulnerabilities/saml.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/saml.html">
            
                    
                    SAML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../authentication-mechanism-and-vulnerabilities/jwt.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/jwt.html">
            
                    
                    JWT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../authentication-mechanism-and-vulnerabilities/two-factor-authentication-checklist.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/two-factor-authentication-checklist.html">
            
                    
                    Two Factor Authentication Checklist
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="./">
            
                <a href="./">
            
                    
                    Browser Security Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="same-origin-policy-sop.html">
            
                <a href="same-origin-policy-sop.html">
            
                    
                    Same Origin Policy (SOP)
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3.2" data-path="cross-origin-resource-sharing-cors.html">
            
                <a href="cross-origin-resource-sharing-cors.html">
            
                    
                    Cross Origin Resource Sharing (CORS)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../security-headers/">
            
                <a href="../security-headers/">
            
                    
                    Security Headers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../security-headers/general.html">
            
                <a href="../security-headers/general.html">
            
                    
                    General
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../security-headers/content-security-policy-csp.html">
            
                <a href="../security-headers/content-security-policy-csp.html">
            
                    
                    Content Security Policy (CSP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../security-headers/cookie-security.html">
            
                <a href="../security-headers/cookie-security.html">
            
                    
                    Cookie Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../android/">
            
                <a href="../../android/">
            
                    
                    Android
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../android/exported-activities.html">
            
                <a href="../../android/exported-activities.html">
            
                    
                    Exported Activities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../android/cheatsheet.html">
            
                <a href="../../android/cheatsheet.html">
            
                    
                    Cheatsheet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Cross Origin Resource Sharing (CORS)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="cross-origin-resource-sharing-cors">Cross Origin Resource Sharing (CORS)</h1>
<p>SOP restricts cross origin websites from reading network response or DOM of other origins for security reasons. But there may be a necessity to allow cross origin response reading or DOM manipulation for specific origin.\
For ex: example.com might need to access data from api.example.com which might be legit.</p>
<p>CORS was introduced to add flexibility to SOP restriction &amp; define access control for resources interacting with cross origin domains.</p>
<h4 id="what-is-a-simple-http-request-">What is a Simple HTTP Request ?</h4>
<p>A request is Simple HTTP Request only if it matches the below conditions - </p>
<ol>
<li><strong>Method</strong>: GET, HEAD, OPTIONS</li>
<li><strong>Content-Type</strong>: The Content-Type request header may contain only application/x-www-form-urlencoded, multipart/form-data or text/plain</li>
<li><strong>No custom headers are included</strong> in request other than <a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header" target="_blank">standard</a> one&apos;s like Accept, Accept-Language, Content-Language, Content-Type, Range (only with a simple range header value; e.g., bytes=256- or bytes=127-255).</li>
</ol>
<h4 id="what-is-a-preflight-request-">What is a PREFLIGHT Request ?</h4>
<p>Any request other than Simple HTTP Request trigger a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight\_request" target="_blank">PREFLIGHT(OPTIONS)</a> request by browser. The initial PREFLIGHT request doesn&apos;t include cookies of cross origin. The value of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" target="_blank">Access-Control-Allow-Origin</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" target="_blank">Access-Control-Allow-Credentials</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Methods" target="_blank">Access-Control-Allow-Methods</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Headers" target="_blank">Access-Control-Allow-Headers</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Expose-Headers" target="_blank">Access-Control-Expose-Headers</a> in response to PREFLIGHT determine whether real request can be made or not, whether real request may include credentials or not &amp; whether cross origin access is permitted for client requesting the real request.</p>
<p>CORS feature depends on response headers provided by server as discussed below.</p>
<p><strong>Few important CORS Response Headers</strong> - </p>
<ol>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" target="_blank"><strong>Access-Control-Allow-Origin</strong></a>:  This header determines whether client can access cross origin resource or not. Absence of this header means by default cross origin resources cannot be accessed by javascript. It may can contain *, \<origin> or null. \<origin> can only be single origin as no browser support multiple origin.  <ul>
<li>Asterisk(*): Any Origin can access the resource, Note that <code>Access-Control-Allow-Credentials: true</code> is not allowed if * is present in Access-Control-Allow-Origin.</li>
<li>\<origin>: Only client request originating from specific origin is allowed. For example: <code>Access-Control-Allow-Origin: http://example.com</code> means, only <a href="http://example.com" target="_blank">http://example.com</a> can access <a href="http://api.example.com" target="_blank">http://api.example.com</a> resources(If client request is made for api.example.com).</origin></li>
<li>null: When local HTML file are used to make cross origin requests, Origin is set to null, This option is used to facilitate local development for testing purpose, But this can option be abused which will be discussed later.</li>
</ul>
</origin></origin></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" target="_blank"><strong>Access-Control-Allow-Credentials</strong></a>: This header tells browser whether or not browser can include credentials in cross origin requests. It may have true or false, true signifies browser may send cookies when making cross origin requests, false signifies browser cannot send cookies for cross origin requests.<ul>
<li>For Simple Requests which do not trigger Preflight(OPTIONS) request, browser will include cookies for cross origin sites by default, If <code>Access-Control-Allow-Credentials: false</code> or absent then the browser doesn&apos;t allow reading of cross origin response or DOM using javascript.</li>
<li>For Requests which trigger Preflight, credentials are not included by default for the preflight request. The real request which takes place after preflight will include credentials only if <code>Access-Control-Allow-Credentials: true</code> is set in response of preflight request.</li>
</ul>
</li>
</ol>
<h4 id="vulnerability-checklist---">Vulnerability Checklist - </h4>
<ol>
<li><strong>Access-Control-Allow-Origin value controlled by client request</strong> - Test If Access-Control-Allow-Origin is reflection of Client side HTTP request headers(typically Origin header), parameters. Note  <code>Access-Control-Allow-Credentials: true</code> must also be set to read the response successfully or do something meaningful. [<a href="https://portswigger.net/web-security/cors/lab-basic-origin-reflection-attack" target="_blank">Portswigger Lab</a>] [<a href="https://portswigger.net/web-security/cors#errors-parsing-origin-headers" target="_blank">Portswigger Blo</a><a href="https://portswigger.net/web-security/cors#errors-parsing-origin-headers" target="_blank">g</a>]</li>
<li><strong>Access-Control-Allow-Origin value contain null -</strong> If null origin is accepted &amp; <code>Access-Control-Allow-Credentials: true</code> also present, then we can try to make sandbox iframe with data scheme to exploit.</li>
<li><strong>Access-Control-Allow-Origin contain *</strong> :  Note although Access-Control-Allow-Origin might contain *, This cannot be used with Access-Control-Allow-Credentials: true, Hence this is not always meaning if authenticated requests are made, But In general <code>Access-Control-Allow-Origin: *</code> is not suggested unless really required.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="same-origin-policy-sop.html" class="navigation navigation-prev " aria-label="Previous page: Same Origin Policy (SOP)">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../security-headers/" class="navigation navigation-next " aria-label="Next page: Security Headers">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Cross Origin Resource Sharing (CORS)","level":"1.2.3.2","depth":3,"next":{"title":"Security Headers","level":"1.2.4","depth":2,"path":"web/security-headers/README.md","ref":"web/security-headers/README.md","articles":[{"title":"General","level":"1.2.4.1","depth":3,"path":"web/security-headers/general.md","ref":"web/security-headers/general.md","articles":[]},{"title":"Content Security Policy (CSP)","level":"1.2.4.2","depth":3,"path":"web/security-headers/content-security-policy-csp.md","ref":"web/security-headers/content-security-policy-csp.md","articles":[]},{"title":"Cookie Security","level":"1.2.4.3","depth":3,"path":"web/security-headers/cookie-security.md","ref":"web/security-headers/cookie-security.md","articles":[]}]},"previous":{"title":"Same Origin Policy (SOP)","level":"1.2.3.1","depth":3,"path":"web/browser-security-features/same-origin-policy-sop.md","ref":"web/browser-security-features/same-origin-policy-sop.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"web/browser-security-features/cross-origin-resource-sharing-cors.md","mtime":"2024-10-10T08:02:12.543Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-10-10T08:02:35.420Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

