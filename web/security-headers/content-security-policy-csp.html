
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Content Security Policy (CSP) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="cookie-security.html" />
    
    
    <link rel="prev" href="general.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Pentest Notes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    Web
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../common-vulnerabilities-and-suggested-fixes.html">
            
                <a href="../common-vulnerabilities-and-suggested-fixes.html">
            
                    
                    Common Vulnerabilities & Suggested Fixes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../authentication-mechanism-and-vulnerabilities/">
            
                <a href="../authentication-mechanism-and-vulnerabilities/">
            
                    
                    Authentication Mechanism & Vulnerabilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../authentication-mechanism-and-vulnerabilities/oauth-2.0.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/oauth-2.0.html">
            
                    
                    OAUTH 2.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../authentication-mechanism-and-vulnerabilities/saml.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/saml.html">
            
                    
                    SAML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../authentication-mechanism-and-vulnerabilities/jwt.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/jwt.html">
            
                    
                    JWT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../authentication-mechanism-and-vulnerabilities/two-factor-authentication-checklist.html">
            
                <a href="../authentication-mechanism-and-vulnerabilities/two-factor-authentication-checklist.html">
            
                    
                    Two Factor Authentication Checklist
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../browser-security-features/">
            
                <a href="../browser-security-features/">
            
                    
                    Browser Security Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../browser-security-features/same-origin-policy-sop.html">
            
                <a href="../browser-security-features/same-origin-policy-sop.html">
            
                    
                    Same Origin Policy (SOP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../browser-security-features/cross-origin-resource-sharing-cors.html">
            
                <a href="../browser-security-features/cross-origin-resource-sharing-cors.html">
            
                    
                    Cross Origin Resource Sharing (CORS)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="./">
            
                <a href="./">
            
                    
                    Security Headers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="general.html">
            
                <a href="general.html">
            
                    
                    General
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.4.2" data-path="content-security-policy-csp.html">
            
                <a href="content-security-policy-csp.html">
            
                    
                    Content Security Policy (CSP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="cookie-security.html">
            
                <a href="cookie-security.html">
            
                    
                    Cookie Security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Content Security Policy (CSP)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="content-security-policy-csp">Content Security Policy (CSP)</h1>
<p>Content Security Policy(CSP) is a additional security layer implemented in browser which tells browser from which origin resources(scripts, css, frames) are allowed/blocked from loading into a website.</p>
<p>CSP is a response header in format - <code>Content-Security-Policy: &lt;directive&gt; &lt;value&gt; &lt;value&gt;; &lt;directive&gt; &lt;value&gt; &lt;value&gt;;</code> </p>
<p>This prevents variety of vulnerabilities like XSS, Clickjacking, Mixed Content Type etc</p>
<p>Example Usages</p>
<ol>
<li><code>Content-Security-Policy: default-src &apos;self&apos;</code> - To allow resources from only site&apos;s origin- to be loaded.</li>
<li><code>Content-Security-Policy: default-src &apos;self&apos; example.com *.example.com</code> - To allow loading resources same origin, from trusted domains &amp; subdomains.</li>
<li><code>Content-Security-Policy: default-src &apos;self&apos;; img-src *; media-src example.org example.net; script-src userscripts.example.com</code> - To allow images to be loaded from any origin, Media(audio,video src) is allowed to be loaded from specific origin, script is allowed to be loaded from specific origin, anhy other content is allowed to be loaded only from same origin.</li>
<li><code>Content-Security-Policy: default-src https://onlinebanking.example.com</code> - To allow resources to be loaded only in HTTPS connection from specific website(can be same origin website also, prevents <strong>Mixed Content</strong> loading).</li>
<li><code>Content-Security-Policy: frame-ancestors &apos;self&apos; https://example.com https://*.example.com;</code> - To allow the website to be embedded, provided parent window is having same origin, or example.com or subdomains of example.com with HTTPS scheme.</li>
<li><code>Content-Security-Policy: frame-ancestors &apos;none&apos;;</code> - This is equivalent to X-Frame-Options: deny &amp; completely prevents clickjacking as it doesn&apos;t allow parent window of any origin to embed the website.</li>
<li><code>Content-Security-Policy: script-src https://example.com/</code> - To allow script to be loaded only from example.com, All inline scripts &amp; event handlers such as <code>&lt;script&gt;alert()&lt;/script&gt;</code> and <code>&lt;button onclick=myFunc()&gt;Submit&lt;/button&gt;</code> will also be blocked.</li>
<li><code>Content-Security-Policy: script-src &apos;sha256-B2yPHKaXnvFWtRChIbabYmUBFZdVfKKXHbWtWidDVF8=&apos;</code> - To allow inline script with specific hash value of it&apos;s content to be used.</li>
<li><code>Content-Security-Policy: script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;</code> - To allow usage of inline scrips, event handlers &amp; also allow dynamic javascript execution using eval().</li>
</ol>
<p>Detailed description &amp; usage of all directives is present available <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank">here</a>.</p>
<p>Refer <a href="https://cheatsheetseries.owasp.org/cheatsheets/Content\_Security\_Policy\_Cheat\_Sheet.html" target="_blank">OWASP Cheatsheet</a> to know about defending specific attacks &amp; CSP configurations.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="general.html" class="navigation navigation-prev " aria-label="Previous page: General">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="cookie-security.html" class="navigation navigation-next " aria-label="Next page: Cookie Security">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Content Security Policy (CSP)","level":"1.2.4.2","depth":3,"next":{"title":"Cookie Security","level":"1.2.4.3","depth":3,"path":"web/security-headers/cookie-security.md","ref":"web/security-headers/cookie-security.md","articles":[]},"previous":{"title":"General","level":"1.2.4.1","depth":3,"path":"web/security-headers/general.md","ref":"web/security-headers/general.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"web/security-headers/content-security-policy-csp.md","mtime":"2024-09-20T09:58:37.976Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-09-20T09:59:01.212Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

